# Todoアプリ

## モチベーション

- この書籍はアプリの作り方を学ぶものではない
- インターフェイスに注目する
- コードの読み方を考える
- 具体的な説明をするが、アプリの作り方の詳細というよりはどのような原理でコンポーネントを考えるかというところに焦点を置く
- 新しいAPIが大量にでてくるため丁寧に

## 目的

- オブジェクト指向なアプリケーション開発
- クラスの使い方
- 状態をもつアプリ
- モジュールの使い方
- イベント駆動/ライフサイクル
    - DOMイベントと自作イベント
- 入力に対する反応としての反応
    - イベント
    - 描画の更新

## 守るべきルール

- セクション間で出したコードはそれぞれ独立して動作すること

## 作るもの

- シンプルなTodoアプリ

### できること

- Todoアイテムの追加
- Todoアイテムの削除
- Todoアイテムの更新（✓）

## イベント

### DOM

- load
- unload
- submit
- click
- change

### アプリ

- Change
    - Add
    - Remove
    - Update

## 状態

- TODOリスト
- Todoアイテム
    - completed
  
## アウトライン

- 目的: モジュールなアプリを開発する
- 目的: イベント駆動を理解する
    - ブラウザ、アプリ
- なぜTodoアプリ
    - 実際にウェブアプリを開発する際にはさまざまな機能が実装されたライブラリやある種のアプリ開発の仕組みをサポートするフレームワークを使うことが現実的です
    - 特にウェブアプリ開発の際にそのスタイルを決めるのは表示を管理するViewのライブラリです
    - ここで実装するTodoアプリと呼ばれるシンプルなタスク管理アプリは、どのViewライブラリでもサンプルとして提供されています
    - TodoMVCというTodoアプリのリファレンス実装があり、各ライブラリはこのTodoMVCを実装したものをサンプルとして提供しています
    - これはユーザーからすれば各ライブラリの書き味を確かめることができ、ライブラリ作者からすればユーザーに慣れ親しんだアプリをどうかけるのを示すサンプルとなります
    - ここで実装するTodoアプリはTodoMVCをもっと簡素化したものですが、このアプリの作り方を理解すれば実際にライブラリを使ったアプリの開発に役立つでしょう
- Todoアプリの構成
    - Todoアプリを実行するブラウザにはいわゆるiOSやAndroidのようにOSが提供するようなフレームワークがデフォルトにはありません
    - そのためさまざまなユーザーが実装したライブラリやフレームワークがあり、それを使ってアプリを作るのが一般的です
    - これは１つのTodoアプリをとっても書き方がかなりの種類があることをしめしています
    - まずは全体像を示してみます
        - HTML
        - JS
        - CSS
    - HTMLは静的です。動的な部分をJavaScriptで管理し構築します
    - CSSは見た目を変更する

## コンポーネント

説明するものをコンポーネントとして見ていく。

- 静的HTML
- CSS
- ディレクトリ構造
- ローカルサーバ    
    - モジュールがCORSにかかるため
- index.js
    - App
    - エントリポイント
- DOMイベント
    - 目的: イベントで表示を更新することを学ぶ
        - ゲームなどを除きDOM要素を使ったウェブアプリは殆どがイベント駆動
        - 時間経過で変化するのではなくイベントによって変化する部分が大体を占める
        - イベントとは何かが**起きた**ことを通知するもの
        - またDOM要素のイベントには発生時にデフォルトの動作が規定されているものがあります。
        - 例えば"click"イベントはクリックと同時に発生し、デフォルトの動作はその要素をclickすることです。
        - DOM Eventはこれらのデフォルトの動作を停止することができます
    - submitを止めてみましょう
    - 止まらなかった場合はリロードされています
    - イベントが発生したらViewを更新してみましょう
        - html-utilを作る?
- EventEmitter
    - 自分でイベントを作ってみましょう
    - なぜEventTargetではない
        - EventTargetはDOMにしかないから
- Model
    - TodoItem
    - TodoList
- View
    - html-util
    - TodoListView

### 動作フロー

- window onload
- App mount
    - Initialize
- Event
    - submit -> update view
    - delete -> update view
    - change -> update view
- View
    - call -> update model
- Model
    - called -> update state -> emit event
- Controller
    - receive event -> call update view

## 新しく登場するAPI

- EventEmitter
- querySelector
- innerHTML
- addEventListner
- event
    - `preventDefault`
- Element
- HTML
    - `<template>`

## 注意事項

他のユースケースと表記は揃える

- HTTPサーバ
- DOM取得（query selector?）
- addEventListnerの第三引数
